<script type="text/javascript">
  function loadImages() {
    var imgDivs = document.getElementsByClassName("box-camera");
    for (var i=0; i<imgDivs.length; i++) {
      var loadingImg = new Image();
      var downloadingImage = imgDivs[i].getElementsByClassName("loadingImg")[0];
      if (downloadingImage) {
        downloadingImage.remove();
      }
      downloadingImage = new Image();
      loadingImg.className = "loadingImg";
      loadingImg.src = "<%= asset_path 'loading.gif' %>";
      imgDivs[i].insertAdjacentElement("afterbegin", loadingImg);
      downloadingImage.changingDiv = imgDivs[i];

      downloadingImage.onload = function () {
        this.changingDiv.innerHTML = "";
        this.changingDiv.append(this);
      };

      downloadingImage.onerror = function() {
        this.changingDiv.getElementsByClassName("loadingImg")[0].src = "<%= asset_path 'mark-icon-51-128x128.png' %>";
      };

      // downloadingImage.src = imgDivs[i].dataset.camera_url;
    }
  }
</script>
